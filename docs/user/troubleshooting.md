# トラブルシューティングガイド

PowerPoint Concierge利用時によくある問題とその解決方法を説明します。

## 🚨 緊急時の対応

### 即座に試すべき基本対応
1. **ページを再読み込み** - ブラウザのF5キー
2. **アドインの再起動** - PowerPointを再起動
3. **インターネット接続の確認** - 他のWebサイトにアクセス
4. **APIキーの確認** - 設定タブでAPIキーを再入力

## 🔑 認証・API関連の問題

### OpenAI APIキーエラー

#### 症状
```
エラーメッセージ:
"OpenAI APIの設定を完了してください"
"API key is invalid"
"Insufficient quota"
```

#### 原因と解決方法

##### 1. APIキーが未設定・間違い
```
確認手順:
1. 設定タブを開く
2. APIキーが正しく入力されているか確認
3. 余分なスペースや改行がないか確認
4. OpenAIアカウントから正しいキーをコピー

解決方法:
- 正しいAPIキーを再入力
- コピー&ペーストで確実に入力
```

##### 2. API利用制限・残高不足
```
確認手順:
1. OpenAI公式サイトにログイン
2. Usage（利用状況）を確認
3. Billing（請求）画面で残高確認

解決方法:
- クレジットカードの再登録
- 利用制限の解除申請
- プランのアップグレード
```

##### 3. API呼び出し回数制限
```
症状: "Rate limit exceeded"
原因: 短時間での大量リクエスト

解決方法:
- 10-15分待ってから再試行
- スライド数を減らして生成
- 分割して処理実行
```

## 📝 コンテンツ生成の問題

### AI詳細化が実行されない

#### 症状
```
- 詳細化が途中で止まる
- 簡単な内容しか生成されない
- "テンプレート最適化が実行されます"と表示
```

#### 原因と解決方法

##### 1. テンプレートが選択されている
```
確認手順:
1. 画面上に「テンプレートモード」の表示がないか確認
2. 選択されたテンプレート情報を確認

解決方法:
1. 「詳細化に変更」ボタンをクリック
2. テンプレート選択画面で「詳細化を使用」をクリック
3. 新しいプレゼンテーションを開始
```

##### 2. アウトラインの問題
```
問題のあるアウトライン:
- スライド数が多すぎる（20枚以上）
- 内容が曖昧・抽象的
- 文字数が極端に少ない

解決方法:
- スライド数を10-15枚に調整
- より具体的な内容に修正
- アウトライン再生成を実行
```

##### 3. ネットワーク・処理エラー
```
症状: 途中で処理が停止
原因: 通信エラー、サーバー負荷

解決方法:
1. 5-10分待ってから再試行
2. スライド数を半分にして実行
3. シンプルな内容で先にテスト
```

### 生成されたコンテンツの品質問題

#### 内容が期待と異なる

##### 1. 入力の改善
```
❌ 悪い例:
"営業について"
"プレゼンテーション作成"

✅ 良い例:
"2024年度第3四半期の新規顧客開拓戦略について、現状の課題分析と具体的な改善提案を含む営業チーム向けプレゼンテーション"
"デジタルマーケティング導入による売上向上施策の効果測定と今後の展開計画"
```

##### 2. アウトライン調整
```
推奨手順:
1. 生成されたアウトラインを詳細確認
2. 不要なスライドの削除
3. 順序の調整
4. タイトルの具体化
5. 内容項目の追加・修正
```

##### 3. 段階的改善
```
アプローチ:
1. 簡単な内容で動作確認
2. 詳細化結果を評価
3. 必要に応じてアウトライン再生成
4. 満足いく結果まで繰り返し
```

## 🎨 デザイン・表示の問題

### テーマが適用されない

#### 症状
```
- 設定したテーマの色が反映されない
- フォントサイズが変わらない
- デフォルトのデザインのまま
```

#### 解決方法
```
1. テーマ設定の再確認:
   - 設定パネルでテーマを再選択
   - プレビューが正しく表示されるか確認

2. キャッシュクリア:
   - ブラウザのキャッシュをクリア
   - アドインの再起動

3. テーマテスト実行:
   - 「テーマをテスト」ボタンで動作確認
   - 3つのテーマすべてで比較

4. PowerPoint再起動:
   - PowerPointアプリケーションの完全再起動
   - アドインの再読み込み
```

### レイアウトが崩れる

#### 狭い画面での表示問題
```
症状:
- ステップインジケーターが見切れる
- ボタンが重なって表示される
- テキストが折り返されない

解決方法:
1. タスクパネルの幅を調整
2. ブラウザのズーム設定を90%に調整
3. 不要なUI要素を閉じる
```

#### スライド内容の表示問題
```
症状:
- テキストが重なる
- 画像が表示されない
- レイアウトが意図と異なる

解決方法:
1. フォントサイズを「中」に変更
2. コンテンツ量を調整
3. PowerPointで手動調整
```

## ⚡ パフォーマンスの問題

### 処理が遅い・重い

#### 大量スライド生成時
```
問題: 15枚以上のスライドで処理が遅い

解決方法:
1. スライド数を10枚以下に分割
2. 複数回に分けて生成
3. 「中」フォントサイズを使用
4. シンプルなテーマを選択
```

#### メモリ不足・ブラウザクラッシュ
```
症状:
- ブラウザが応答しなくなる
- "Out of memory"エラー
- 処理が途中で止まる

解決方法:
1. 他のタブ・アプリケーションを閉じる
2. ブラウザを再起動
3. PCを再起動
4. 分割処理で実行
```

## 🔧 テンプレート関連の問題

### テンプレートが推奨されない

#### 症状
```
- 作成したテンプレートが表示されない
- 「テンプレート選択」パネルが出ない
- 推奨スコアが低い
```

#### 解決方法
```
1. タグの見直し:
   - より具体的なキーワードを追加
   - 一般的な用語を含める
   - カテゴリとの整合性を確認

2. メタデータの調整:
   - 対象聴衆の設定を確認
   - 目的の設定を見直し
   - より広範囲の用途に対応

3. テンプレート再作成:
   - より多様なサンプルスライドを含める
   - デザインパターンを明確化
   - 説明文を詳細化
```

### テンプレート登録エラー

#### 症状
```
- "テンプレートの登録に失敗しました"
- 保存されたテンプレートが表示されない
```

#### 解決方法
```
1. 元プレゼンテーションの確認:
   - 最低3-5枚のスライドが必要
   - 様々なスライドタイプを含める
   - 明確なデザインパターンを設定

2. ブラウザストレージの確認:
   - ローカルストレージの容量確認
   - プライベートブラウジングモードを避ける
   - Cookieの設定を確認

3. 再登録の実行:
   - フォームをリセットして再入力
   - 異なる名前で再登録
   - 段階的に情報を入力
```

## 🐛 既知の問題と回避策

### Office.js API制限
```
問題: PowerPoint.js APIの機能制限
影響: 一部の高度な機能が利用不可

回避策:
- サポートされる機能の範囲内で利用
- PowerPointの手動調整を併用
- 将来のAPI更新を待つ
```

### ブラウザ互換性
```
問題: 一部ブラウザでの動作不安定
推奨: Microsoft Edge, Chrome最新版

回避策:
- 推奨ブラウザでの利用
- ブラウザを最新版にアップデート
- 必要に応じて設定調整
```

### 大量データ処理
```
問題: 20枚以上のスライドで処理不安定
制限: メモリとAPI呼び出し制限

回避策:
- 10-15枚ずつに分割
- 段階的な処理実行
- 定期的な保存・バックアップ
```

## 📞 サポート・問い合わせ

### 自己診断チェックリスト
```
□ APIキーが正しく設定されている
□ インターネット接続が安定している
□ ブラウザが最新版である
□ 他のタブ・アプリを閉じている
□ 適切なスライド数（10-15枚）である
□ 具体的な入力内容を提供している
□ テンプレート選択状態を確認している
```

### エラー情報の収集
```
問題報告時に含めるべき情報:
1. エラーメッセージの全文
2. 実行していた操作の詳細
3. 使用環境（OS, ブラウザ, PowerPointバージョン）
4. コンソールログ（F12キーで確認）
5. 再現手順
```

### 緊急時の代替手段
```
システムが利用できない場合:
1. PowerPoint標準機能での手動作成
2. 生成済みコンテンツの再利用
3. シンプルな構成での再実行
4. オフライン作業への切り替え
```

適切なトラブルシューティングにより、PowerPoint Conciergeを安定して活用できます。問題が解決しない場合は、上記の情報を整理してサポートにお問い合わせください。